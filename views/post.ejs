<!DOCTYPE html>
<html lang="en">
	<%- include('./partial/header.ejs') -%>

	<body>
    <%- include('./partial/nav.ejs') %>
    <container>
      <article>
        <div class="info">
          <h2><%= post.title %></h2>
          <button class="btn-delete" data-id="<%= post._id %>">
            <i class="fa-solid fa-trash-can" data-id="<%= post._id %>"></i>
          </button>
        </div>
        <p><%= post.text %></p>
        <div class="info">
          <span><%= post._created ? new Date(post._created).toLocaleDateString() : 'No Date' %></span>
          <%= console.log(post) %>
          <span><%= post.author %></span>
        </div>
      </article>
    </container>

    <script>
			document.addEventListener('click', e => {
				const id = e.target?.dataset?.id || null
				if (id) {
					fetch(`/posts/${id}`, {
						method: 'DELETE'
					}).then(() => {
						window.location.reload()
						window.location.href = '/posts'
					})
				}
			})
		</script>
	</body>
</html>
